{% extends "base.html" %}
{% block content %}
  <div class="flex items-center justify-between">
    <h1 class="text-xl font-semibold">我的预约</h1>
    <a href="/logout" class="text-sm text-slate-600 underline">退出</a>
  </div>

  {% if msg %}
    <div class="mt-3 rounded-lg border bg-white p-3 text-sm text-slate-700">
      {{ msg }}
    </div>
  {% endif %}

  <a href="/member" class="mt-3 inline-block text-sm text-slate-600 underline">返回预约</a>

  <div class="mt-4 space-y-2">
    {% if not items %}
      <div class="rounded-xl border bg-white p-4 text-sm text-slate-700">暂无预约记录</div>
    {% endif %}
    {% for it in items %}
      <div class="rounded-xl border bg-white p-4">
        <div class="flex items-center justify-between">
          <div>
            <div class="text-sm font-medium">{{ it.booking.date }} · {{ it.start_hm }} - {{ it.end_hm }}</div>
            <div class="mt-1 text-xs text-slate-500">教练：{{ it.coach.display_name }}</div>
          </div>
          <div class="text-xs text-slate-600">{{ it.booking.status.value }}</div>
        </div>

        {% if it.booking.decision_note %}
          <div class="mt-2 text-xs text-slate-500">备注：{{ it.booking.decision_note }}</div>
        {% endif %}

        {% if it.booking.status.value in ["pending", "confirmed"] %}
          <form method="post" action="/member/bookings/{{ it.booking.id }}/cancel" class="mt-3">
            <button class="rounded-lg border px-3 py-2 text-sm">取消预约</button>
          </form>
        {% endif %}
      </div>
    {% endfor %}
  </div>
{% endblock %}
