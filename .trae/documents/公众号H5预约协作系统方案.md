## 目标与范围（MVP）
- 形态：微信公众号菜单/图文跳转的 H5 移动端网页（非小程序），适配微信内置浏览器
- 角色：会员（预约）、教练（确认/拒绝）、前台/管理员（配置时间段、开关预约、管理账号）
- 登录：用户名 + 密码（小范围使用），后端做角色权限控制
- 核心流程：会员提交预约 → 状态“待确认” → 教练确认/拒绝 → 会员查看结果；会员可取消未开始的预约

## 关键业务规则
- 时间段规则：每天可配置营业开始/结束时间、单节时长（如 60min）、间隔/缓冲（可选）、每个时间段是否可预约、每个时间段容量（默认 1）
- 冲突规则：同一教练同一时间段不可超容量；同一会员同一时间段不可重复预约
- 状态机：pending（待确认）/ confirmed（已确认）/ rejected（已拒绝）/ cancelled（已取消）/ expired（已过期可选）

## 页面与交互（移动端优先）
- 公共：登录页、重置密码（管理员操作或简单“改密”）
- 会员端：
  - 教练列表/选择教练
  - 日历/日期选择 + 当日可预约时间段列表
  - 提交预约、查看我的预约（按状态分组）
- 教练端：
  - 今日/本周预约请求列表
  - 一键确认/拒绝（可填写拒绝原因）
- 前台/后台（可先做一个“管理端”即可）：
  - 用户管理：创建会员/教练账号、角色分配、禁用
  - 时间配置：按教练设置每日营业时间、时长、容量、开关；支持按日期例外（节假日关闭、临时加开）
  - 预约管理：查看、手动改状态（可选）

## 数据模型（最小集合）
- users：id、username、password_hash、role（member/coach/admin/frontdesk）、is_active、created_at
- coaches：user_id、display_name、notes（可选）
- members：user_id、display_name、phone（可选）
- availability_rules（常规规则）：coach_id、weekday、start_time、end_time、slot_minutes、capacity、enabled
- availability_exceptions（按日期例外）：coach_id、date、start_time、end_time、capacity、enabled
- bookings：id、coach_id、member_id、date、start_time、end_time、status、created_at、updated_at、decision_note（可选）

## API 设计（按资源划分）
- 认证：POST /auth/login、POST /auth/logout、GET /me
- 会员侧：GET /coaches、GET /coaches/:id/availability?date=YYYY-MM-DD、POST /bookings、GET /bookings?mine=1、POST /bookings/:id/cancel
- 教练侧：GET /bookings?asCoach=1&from=&to=、POST /bookings/:id/confirm、POST /bookings/:id/reject
- 管理侧：CRUD /users、CRUD /availability_rules、CRUD /availability_exceptions、GET /bookings（筛选）
- 约束：所有写操作校验角色 + 业务冲突（容量/重复/时间窗口）

## 技术选型（建议）
- 前端：React（Next.js 或 Vite 均可），移动端 UI 走简洁表单 + 列表（必要时引入轻量组件库）
- 后端：Node.js（REST API）
- 数据库：SQLite（单机小范围最省事）；若未来多人并发/迁移方便，可换 Postgres
- ORM/迁移：使用带迁移能力的 ORM（便于后续扩表）
- 鉴权：基于 HttpOnly Cookie 的会话（简单、适合 H5）；配合 CSRF 防护

## 部署与公众号接入
- 部署：1 台小型服务器（Docker + Nginx 反代），全站 HTTPS（公众号跳转强烈建议）
- 公众号：自定义菜单指向 H5 地址；如需分享/定位/扫码再接微信 JS-SDK（MVP 可不做）

## 安全与可运维性
- 密码：强哈希（bcrypt/argon2），不记录明文
- 防滥用：登录限流、基础审计日志（可选）
- 权限：所有接口做 RBAC；管理端操作可加二次确认
- 备份：SQLite 定时备份文件；或数据库快照

## 验证与测试
- 业务单测：时间段生成、冲突检测、状态流转
- 端到端：会员预约→教练确认→会员看到结果

## 交付顺序（实现步骤）
1. 初始化项目骨架（前后端、环境变量、基础路由）
2. 用户/角色/登录会话与权限中间件
3. 时间配置（规则 + 例外）与“某日可预约时间段”计算
4. 预约创建/取消 + 冲突校验
5. 教练确认/拒绝 + 会员/教练列表页
6. 管理端（用户管理、时间配置开关、预约查询）
7. 部署脚本与基础监控/备份

我已根据你的描述整理出可落地的 MVP 方案。确认后我会按上述步骤在当前工作目录里把项目从零搭起来，并把每个页面/接口跑通。